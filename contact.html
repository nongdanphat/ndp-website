<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Liên hệ - NDP</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- ============================================ -->
    <!-- CẤU HÌNH - Thay đổi URL bên dưới -->
    <!-- ============================================ -->
    <script>
      const CONTACT_SCRIPT_URL =
        "https://script.google.com/macros/s/AKfycbzl2pV61fWLKtTAx50vfTFn562_l3tGHQLA8VJUISu0kudW7BZg8kVKNtSlmdodZKS9/exec";
    </script>
  </head>
  <body class="bg-white text-gray-900">
    <!-- Header placeholder - will be loaded dynamically -->
    <div id="header-placeholder"></div>

    <!-- Main Content -->
    <main class="min-h-screen py-12">
      <div class="container mx-auto px-4 max-w-4xl">
        <h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-8">
          Liên hệ
        </h1>

        <div class="grid md:grid-cols-2 gap-8">
          <!-- Contact Information -->
          <div
            class="bg-gradient-to-br from-[#FADC7C] to-white p-6 rounded-xl shadow-md"
          >
            <h2 class="text-xl font-semibold mb-4">Thông tin liên hệ</h2>
            <div class="space-y-4">
              <div class="flex items-start">
                <svg
                  class="w-5 h-5 text-[#AB7E31] mt-1 mr-3"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
                  ></path>
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
                  ></path>
                </svg>
                <div>
                  <p class="font-medium">Địa chỉ</p>
                  <p class="text-gray-600">
                    123 Đường ABC, Quận XYZ, TP. Hồ Chí Minh
                  </p>
                </div>
              </div>
              <div class="flex items-start">
                <svg
                  class="w-5 h-5 text-[#AB7E31] mt-1 mr-3"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"
                  ></path>
                </svg>
                <div>
                  <p class="font-medium">Điện thoại</p>
                  <p class="text-gray-600">+84 123 456 789</p>
                </div>
              </div>
              <div class="flex items-start">
                <svg
                  class="w-5 h-5 text-[#AB7E31] mt-1 mr-3"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
                  ></path>
                </svg>
                <div>
                  <p class="font-medium">Email</p>
                  <p class="text-gray-600">contact@ndp.com</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Contact Form -->
          <div class="bg-white border border-gray-200 p-6 rounded-xl shadow-md">
            <h2 class="text-xl font-semibold mb-4">Gửi tin nhắn</h2>
            <form id="contact-form" class="space-y-4">
              <div>
                <label
                  for="name"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Họ và tên <span class="text-red-500">*</span></label
                >
                <input
                  type="text"
                  id="name"
                  name="name"
                  required
                  class="w-full px-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#AB7E31] focus:border-transparent"
                />
              </div>
              <div>
                <label
                  for="email"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Email <span class="text-red-500">*</span></label
                >
                <input
                  type="email"
                  id="email"
                  name="email"
                  required
                  class="w-full px-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#AB7E31] focus:border-transparent"
                />
              </div>
              <div>
                <label
                  for="phone"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Số điện thoại <span class="text-red-500">*</span></label
                >
                <input
                  type="tel"
                  id="phone"
                  name="phone"
                  required
                  inputmode="numeric"
                  pattern="[0-9]*"
                  class="w-full px-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#AB7E31] focus:border-transparent"
                />
              </div>
              <div>
                <label
                  for="message"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Tin nhắn <span class="text-red-500">*</span></label
                >
                <textarea
                  id="message"
                  name="message"
                  rows="4"
                  required
                  class="w-full px-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#AB7E31] focus:border-transparent"
                ></textarea>
              </div>
              <div
                id="contact-message"
                class="hidden mt-4 p-4 rounded-xl"
              ></div>
              <button
                type="submit"
                id="contact-submit-button"
                class="w-full bg-gradient-to-r from-[#AB7E31] to-[#BE8F2B] text-white py-3 px-4 rounded-xl hover:shadow-lg transition font-medium shadow-md disabled:opacity-50 disabled:cursor-not-allowed"
              >
                Gửi tin nhắn
              </button>
            </form>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer placeholder - will be loaded dynamically -->
    <div id="footer-placeholder"></div>

    <!-- Load header and footer -->
    <script src="/load-header-footer.js"></script>

    <!-- JavaScript -->
    <script>
      // Xử lý input số điện thoại - chỉ nhận số
      const phoneInput = document.getElementById("phone");
      phoneInput.addEventListener("input", function (e) {
        let value = e.target.value.replace(/\D/g, "");
        if (value.length > 11) {
          value = value.substring(0, 11);
        }
        e.target.value = value;
      });

      // Form submission
      const contactForm = document.getElementById("contact-form");
      const contactSubmitButton = document.getElementById(
        "contact-submit-button"
      );
      const contactMessage = document.getElementById("contact-message");

      function showContactMessage(text, type) {
        contactMessage.textContent = text;
        contactMessage.className = `mt-4 p-4 rounded-xl ${
          type === "error"
            ? "bg-red-50 text-red-700 border border-red-200"
            : "bg-green-50 text-green-700 border border-green-200"
        }`;
        contactMessage.classList.remove("hidden");
        setTimeout(() => {
          contactMessage.classList.add("hidden");
        }, 5000);
      }

      contactForm.addEventListener("submit", async (e) => {
        e.preventDefault();

        if (CONTACT_SCRIPT_URL === "YOUR_CONTACT_FORM_SCRIPT_URL") {
          showContactMessage(
            "Vui lòng cấu hình CONTACT_SCRIPT_URL trong code.",
            "error"
          );
          return;
        }

        contactSubmitButton.disabled = true;
        contactSubmitButton.textContent = "Đang gửi...";

        // Lấy số điện thoại và format
        let phoneValue = document
          .getElementById("phone")
          .value.replace(/\D/g, "");
        phoneValue = phoneValue || "";

        const formData = {
          name: document.getElementById("name").value,
          email: document.getElementById("email").value,
          phone: phoneValue,
          message: document.getElementById("message").value,
        };

        try {
          // Sử dụng form submission với iframe ẩn để tránh CORS
          const iframe = document.createElement("iframe");
          iframe.name = "hidden-contact-iframe-" + Date.now();
          iframe.style.position = "fixed";
          iframe.style.left = "-9999px";
          iframe.style.top = "-9999px";
          iframe.style.width = "1px";
          iframe.style.height = "1px";
          iframe.style.border = "none";
          iframe.style.opacity = "0";
          iframe.style.pointerEvents = "none";

          document.body.appendChild(iframe);

          const hiddenForm = document.createElement("form");
          hiddenForm.method = "POST";
          hiddenForm.action = CONTACT_SCRIPT_URL;
          hiddenForm.target = iframe.name;
          hiddenForm.style.display = "none";

          // Thêm dữ liệu vào form
          Object.keys(formData).forEach((key) => {
            const input = document.createElement("input");
            input.type = "hidden";
            input.name = key;
            input.value = formData[key];
            hiddenForm.appendChild(input);
          });

          document.body.appendChild(hiddenForm);

          let isCompleted = false;

          const handleSuccess = () => {
            if (isCompleted) return;
            isCompleted = true;

            showContactMessage(
              "Tin nhắn đã được gửi thành công! Chúng tôi sẽ liên hệ với bạn sớm nhất.",
              "success"
            );
            contactForm.reset();

            setTimeout(() => {
              if (hiddenForm.parentNode) {
                document.body.removeChild(hiddenForm);
              }
              if (iframe.parentNode) {
                document.body.removeChild(iframe);
              }
            }, 2000);

            contactSubmitButton.disabled = false;
            contactSubmitButton.textContent = "Gửi tin nhắn";
          };

          const timeoutId = setTimeout(() => {
            handleSuccess();
          }, 2000);

          hiddenForm.submit();

          iframe.onload = function () {
            clearTimeout(timeoutId);
            handleSuccess();
          };
        } catch (error) {
          console.error("Form submission error:", error);
          showContactMessage(
            "Có lỗi xảy ra khi gửi tin nhắn. Vui lòng thử lại sau.",
            "error"
          );
          contactSubmitButton.disabled = false;
          contactSubmitButton.textContent = "Gửi tin nhắn";
        }
      });
    </script>
  </body>
</html>
